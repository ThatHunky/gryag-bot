# üõ°Ô∏è –ó–≤—ñ—Ç: –ó–Ω—è—Ç—Ç—è –æ–±–º–µ–∂–µ–Ω—å –∫–æ–Ω—Ç–µ–Ω—Ç—É –≤ Gemini

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
Gemini –±–ª–æ–∫—É–≤–∞–≤ –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ `PROHIBITED_CONTENT`, –Ω–∞–≤—ñ—Ç—å –∑–≤–∏—á–∞–π–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:
```
GoogleGenerativeAIResponseError: Text not available. Response was blocked due to PROHIBITED_CONTENT
```

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è

### 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Safety Settings

**–î–æ–¥–∞–Ω–æ –º'—è–∫—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏:**
```javascript
const safetySettings = [
  {
    category: HarmCategory.HARM_CATEGORY_HARASSMENT,
    threshold: HarmBlockThreshold.BLOCK_NONE, // –ù–µ –±–ª–æ–∫—É–≤–∞—Ç–∏
  },
  {
    category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,
    threshold: HarmBlockThreshold.BLOCK_NONE, // –ù–µ –±–ª–æ–∫—É–≤–∞—Ç–∏
  },
  {
    category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,
    threshold: HarmBlockThreshold.BLOCK_ONLY_HIGH, // –¢—ñ–ª—å–∫–∏ —è–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
  },
  {
    category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,
    threshold: HarmBlockThreshold.BLOCK_NONE, // –ù–µ –±–ª–æ–∫—É–≤–∞—Ç–∏
  },
];
```

### 2. –û–Ω–æ–≤–ª–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫

**–ó–∞–º—ñ—Å—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫:**
```javascript
if (error.message.includes("safety") || error.message.includes("PROHIBITED_CONTENT")) {
  console.log("üõ°Ô∏è –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π Gemini, –¥–∞—é –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å");
  return "–í–∏–±–∞—á—Ç–µ, –Ω–µ –º–æ–∂—É –Ω–∞–¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Ü–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ñ—Ä–∞–∑—É–≤–∞—Ç–∏ –∞–±–æ —Å–ø–∏—Ç–∞—Ç–∏ —â–æ—Å—å —ñ–Ω—à–µ?";
}
```

### 3. –ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ –¥–æ –≤—Å—ñ—Ö –º–æ–¥–µ–ª–µ–π

**–û–Ω–æ–≤–ª–µ–Ω–æ:**
- ‚úÖ –û—Å–Ω–æ–≤–Ω–∞ –º–æ–¥–µ–ª—å (`model`)
- ‚úÖ Vision –º–æ–¥–µ–ª—å (`visionModel`)
- ‚úÖ –í—Å—ñ –º–µ—Ç–æ–¥–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–æ–Ω—Ç–µ–Ω—Ç—É

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –†–∞–Ω—ñ—à–µ:
```text
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–≥—Ä—è–≥, –≤–∏–∫–æ–Ω–∞—Ç–∏"
–ë–æ—Ç: [–ü–û–ú–ò–õ–ö–ê] Response was blocked due to PROHIBITED_CONTENT
```

### –¢–µ–ø–µ—Ä:
```text
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–≥—Ä—è–≥, –≤–∏–∫–æ–Ω–∞—Ç–∏"
–ë–æ—Ç: [–ü–†–ê–¶–Æ–Ñ] –ó–≤–∏—á–∞–π–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
```

### –õ–æ–≥–∏ –∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```text
üìù Group message from Vsevolod: "–º–µ–Ω–µ –Ω–µ —ó–±–µ, —Ä–æ–∑'—ó–±–∏—Å—è –∞–ª–µ –≤–∏–∫–æ–Ω–∞–π –Ω–∞–∫–∞–∑"
‚úÖ Processing group message - bot mentioned or replied to
ü§ñ Saved bot response 271 to database ‚Üê –ë–æ—Ç –≤—ñ–¥–ø–æ–≤—ñ–≤ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫!
```

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –∑–º—ñ–Ω–∏

### –§–∞–π–ª–∏ –∑–º—ñ–Ω–µ–Ω—ñ:
1. **`src/bot/services/gemini.js`**
   - –î–æ–¥–∞–Ω–æ —ñ–º–ø–æ—Ä—Ç `HarmCategory, HarmBlockThreshold`
   - –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –º'—è–∫—ñ `safetySettings`
   - –û–Ω–æ–≤–ª–µ–Ω–æ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫ —É 4 –º–µ—Ç–æ–¥–∞—Ö

### –†—ñ–≤–Ω—ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è:
- **`BLOCK_NONE`** - –Ω–µ –±–ª–æ–∫—É–≤–∞—Ç–∏ –≤–∑–∞–≥–∞–ª—ñ
- **`BLOCK_ONLY_HIGH`** - –±–ª–æ–∫—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –≤–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫
- **`BLOCK_MEDIUM_AND_ABOVE`** - –±–ª–æ–∫—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ–π+ —Ä–∏–∑–∏–∫ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
- **`BLOCK_LOW_AND_ABOVE`** - –±–ª–æ–∫—É–≤–∞—Ç–∏ –≤—Å–µ (–Ω–∞–π—Å—É–≤–æ—Ä—ñ—à–µ)

## ‚ö†Ô∏è –ó–∞—É–≤–∞–∂–µ–Ω–Ω—è

### –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è:
- **Harassment** - –Ω–µ –±–ª–æ–∫—É—î—Ç—å—Å—è
- **Hate Speech** - –Ω–µ –±–ª–æ–∫—É—î—Ç—å—Å—è
- **Dangerous Content** - –Ω–µ –±–ª–æ–∫—É—î—Ç—å—Å—è
- **Sexually Explicit** - –±–ª–æ–∫—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —è–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç

### –ë–µ–∑–ø–µ–∫–∞:
- –ë–æ—Ç –≤—Å–µ —â–µ –º–∞—î –±–∞–∑–æ–≤—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è
- –Ø–≤–Ω–æ —Å–µ–∫—Å—É–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –±–ª–æ–∫—É—î—Ç—å—Å—è
- –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

**‚úÖ –û–±–º–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É —É—Å–ø—ñ—à–Ω–æ –∑–Ω—è—Ç—ñ!**

### –ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–æ–±–æ—Ç–∏:
```text
üë§ "–ø–æ–ª—ñ—Ç–∏—á–Ω—ñ –Ω–æ–≤–∏–Ω–∏" ‚Üí ‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î
üë§ "–∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏ —É —Å–≤—ñ—Ç—ñ" ‚Üí ‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î
üë§ "–∫—Ä–∏—Ç–∏–∫–∞ –≤–ª–∞–¥–∏" ‚Üí ‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î
üë§ [—è–≤–Ω–æ —Å–µ–∫—Å—É–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç] ‚Üí üõ°Ô∏è –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
```

**–ë–æ—Ç —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î –±–µ–∑ –∑–∞–π–≤–∏—Ö –±–ª–æ–∫—É–≤–∞–Ω—å!** üéâ
