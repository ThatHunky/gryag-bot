# gryag

Telegram груповий бот з характером: короткі дотепні відповіді українською, живиться Gemini Flash 2.5 та пам'ятає контекст бесіди.

## Фічі
- Відповідає лише коли тегнули, відповіли або згадали «гряг/gryag».
- Підтягує останні репліки з SQLite (опціонально Redis для швидкого тротлінгу).
- Підтримує зображення та голосові повідомлення — коротко описує їх у відповіді.
- Обмежує кожного користувача до 5 звернень на годину в одному чаті.
- Гострий сарказм, чорний гумор, українська за замовчуванням.

## Швидкий старт
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
cp .env.example .env
# заповніть TELEGRAM_TOKEN та GEMINI_API_KEY
python -m app.main
```

## Налаштування
- Змінні середовища описані в `.env.example` (модель, шлях до БД, ліміт історії, тротлінг).
- База `SQLite` зберігає повідомлення й квоти; схема лежить у `db/schema.sql`.
- Увімкніть Redis (опціонально) через `USE_REDIS=true` та вкажіть `REDIS_URL` — тротлінг працюватиме через Redis, але SQLite лишаться як бек-ап для історії.

## Поведінка
- Контекст: зберігаються до 50 останніх повідомлень для кожної пари `chat_id + thread`.
- Тригери: бот реагує на `@username`, реплай власного повідомлення або згадку «гряг/gryag» без модераційних фільтрів.
- Якщо файл — фото/документ з MIME `image/*` чи `audio/*`, або voice — бот завантажує його та відправляє в Gemini.
- При перевищенні ліміту: миттєва різка відповідь ігнорує подальшу обробку протягом години.

## Ліцензія
MIT
